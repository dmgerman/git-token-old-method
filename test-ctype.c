begin_unit
begin_include
include|#
directive|include
file|"cache.h"
end_include
begin_decl_stmt
DECL|variable|rc
specifier|static
name|int
name|rc
decl_stmt|;
end_decl_stmt
begin_function
DECL|function|report_error
specifier|static
name|void
name|report_error
parameter_list|(
specifier|const
name|char
modifier|*
name|class
parameter_list|,
name|int
name|ch
parameter_list|)
block|{
name|printf
argument_list|(
literal|"%s classifies char %d (0x%02x) wrongly\n"
argument_list|,
name|class
argument_list|,
name|ch
argument_list|,
name|ch
argument_list|)
expr_stmt|;
name|rc
operator|=
literal|1
expr_stmt|;
block|}
end_function
begin_function
DECL|function|is_in
specifier|static
name|int
name|is_in
parameter_list|(
specifier|const
name|char
modifier|*
name|s
parameter_list|,
name|int
name|ch
parameter_list|)
block|{
comment|/* We can't find NUL using strchr.  It's classless anyway. */
if|if
condition|(
name|ch
operator|==
literal|'\0'
condition|)
return|return
literal|0
return|;
return|return
operator|!
operator|!
name|strchr
argument_list|(
name|s
argument_list|,
name|ch
argument_list|)
return|;
block|}
end_function
begin_define
DECL|macro|TEST_CLASS
define|#
directive|define
name|TEST_CLASS
parameter_list|(
name|t
parameter_list|,
name|s
parameter_list|)
value|{			\ 	int i;					\ 	for (i = 0; i< 256; i++) {		\ 		if (is_in(s, i) != t(i))	\ 			report_error(#t, i);	\ 	}					\ }
end_define
begin_define
DECL|macro|DIGIT
define|#
directive|define
name|DIGIT
value|"0123456789"
end_define
begin_define
DECL|macro|LOWER
define|#
directive|define
name|LOWER
value|"abcdefghijklmnopqrstuvwxyz"
end_define
begin_define
DECL|macro|UPPER
define|#
directive|define
name|UPPER
value|"ABCDEFGHIJKLMNOPQRSTUVWXYZ"
end_define
begin_function
DECL|function|main
name|int
name|main
parameter_list|(
name|int
name|argc
parameter_list|,
name|char
modifier|*
modifier|*
name|argv
parameter_list|)
block|{
name|TEST_CLASS
argument_list|(
name|isdigit
argument_list|,
name|DIGIT
argument_list|)
expr_stmt|;
name|TEST_CLASS
argument_list|(
name|isspace
argument_list|,
literal|" \n\r\t"
argument_list|)
expr_stmt|;
name|TEST_CLASS
argument_list|(
argument|isalpha
argument_list|,
argument|LOWER UPPER
argument_list|)
empty_stmt|;
name|TEST_CLASS
argument_list|(
argument|isalnum
argument_list|,
argument|LOWER UPPER DIGIT
argument_list|)
empty_stmt|;
name|TEST_CLASS
argument_list|(
name|is_glob_special
argument_list|,
literal|"*?[\\"
argument_list|)
expr_stmt|;
name|TEST_CLASS
argument_list|(
name|is_regex_special
argument_list|,
literal|"$()*+.?[\\^{|"
argument_list|)
expr_stmt|;
return|return
name|rc
return|;
block|}
end_function
end_unit
