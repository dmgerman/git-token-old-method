begin_unit
comment|'#!/usr/bin/python'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# p4-debug.py'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Author: Simon Hausmann <hausmann@kde.org>'
nl|'\n'
comment|'# License: MIT <http://www.opensource.org/licenses/mit-license.php>'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# removes unused p4 import tags'
nl|'\n'
comment|'#'
nl|'\n'
name|'import'
name|'os'
op|','
name|'string'
op|','
name|'sys'
newline|'\n'
name|'import'
name|'popen2'
op|','
name|'getopt'
newline|'\n'
nl|'\n'
DECL|variable|branch
name|'branch'
op|'='
string|'"refs/heads/master"'
newline|'\n'
nl|'\n'
name|'try'
op|':'
newline|'\n'
indent|'    '
name|'opts'
op|','
name|'args'
op|'='
name|'getopt'
op|'.'
name|'getopt'
op|'('
name|'sys'
op|'.'
name|'argv'
op|'['
number|'1'
op|':'
op|']'
op|','
string|'""'
op|','
op|'['
string|'"branch="'
op|']'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'getopt'
op|'.'
name|'GetoptError'
op|':'
newline|'\n'
indent|'    '
name|'print'
string|'"fixme, syntax error"'
newline|'\n'
name|'sys'
op|'.'
name|'exit'
op|'('
number|'1'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'for'
name|'o'
op|','
name|'a'
name|'in'
name|'opts'
op|':'
newline|'\n'
indent|'    '
name|'if'
name|'o'
op|'=='
string|'"--branch"'
op|':'
newline|'\n'
DECL|variable|branch
indent|'        '
name|'branch'
op|'='
string|'"refs/heads/"'
op|'+'
name|'a'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'sout'
op|','
name|'sin'
op|','
name|'serr'
op|'='
name|'popen2'
op|'.'
name|'popen3'
op|'('
string|'"git-name-rev --tags `git-rev-parse %s`"'
op|'%'
name|'branch'
op|')'
newline|'\n'
DECL|variable|output
name|'output'
op|'='
name|'sout'
op|'.'
name|'read'
op|'('
op|')'
newline|'\n'
DECL|variable|tagIdx
name|'tagIdx'
op|'='
name|'output'
op|'.'
name|'index'
op|'('
string|'" tags/p4/"'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
DECL|variable|caretIdx
indent|'    '
name|'caretIdx'
op|'='
name|'output'
op|'.'
name|'index'
op|'('
string|'"^"'
op|')'
newline|'\n'
dedent|''
name|'except'
op|':'
newline|'\n'
DECL|variable|caretIdx
indent|'    '
name|'caretIdx'
op|'='
name|'len'
op|'('
name|'output'
op|')'
op|'-'
number|'1'
newline|'\n'
DECL|variable|rev
dedent|''
name|'rev'
op|'='
name|'int'
op|'('
name|'output'
op|'['
name|'tagIdx'
op|'+'
number|'9'
op|':'
name|'caretIdx'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|variable|allTags
name|'allTags'
op|'='
name|'os'
op|'.'
name|'popen'
op|'('
string|'"git tag -l p4/"'
op|')'
op|'.'
name|'readlines'
op|'('
op|')'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
name|'len'
op|'('
name|'allTags'
op|')'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'allTags'
op|'['
name|'i'
op|']'
op|'='
name|'int'
op|'('
name|'allTags'
op|'['
name|'i'
op|']'
op|'['
number|'3'
op|':'
op|'-'
number|'1'
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'allTags'
op|'.'
name|'sort'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'allTags'
op|'.'
name|'remove'
op|'('
name|'rev'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'rev'
name|'in'
name|'allTags'
op|':'
newline|'\n'
indent|'    '
name|'print'
name|'os'
op|'.'
name|'popen'
op|'('
string|'"git tag -d p4/%s"'
op|'%'
name|'rev'
op|')'
op|'.'
name|'read'
op|'('
op|')'
newline|'\n'
dedent|''
endmarker|''
end_unit
