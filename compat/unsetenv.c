begin_unit
begin_include
include|#
directive|include
file|"../git-compat-util.h"
end_include
begin_function
DECL|function|gitunsetenv
name|void
name|gitunsetenv
parameter_list|(
specifier|const
name|char
modifier|*
name|name
parameter_list|)
block|{
specifier|extern
name|char
modifier|*
modifier|*
name|environ
decl_stmt|;
name|int
name|src
decl_stmt|,
name|dst
decl_stmt|;
name|size_t
name|nmln
decl_stmt|;
name|nmln
operator|=
name|strlen
argument_list|(
name|name
argument_list|)
expr_stmt|;
for|for
control|(
name|src
operator|=
name|dst
operator|=
literal|0
init|;
name|environ
index|[
name|src
index|]
condition|;
operator|++
name|src
control|)
block|{
name|size_t
name|enln
decl_stmt|;
name|enln
operator|=
name|strlen
argument_list|(
name|environ
index|[
name|src
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|enln
operator|>
name|nmln
condition|)
block|{
comment|/* might match, and can test for '=' safely */
if|if
condition|(
literal|0
operator|==
name|strncmp
argument_list|(
name|environ
index|[
name|src
index|]
argument_list|,
name|name
argument_list|,
name|nmln
argument_list|)
operator|&&
literal|'='
operator|==
name|environ
index|[
name|src
index|]
index|[
name|nmln
index|]
condition|)
comment|/* matches, so skip */
continue|continue;
block|}
name|environ
index|[
name|dst
index|]
operator|=
name|environ
index|[
name|src
index|]
expr_stmt|;
operator|++
name|dst
expr_stmt|;
block|}
name|environ
index|[
name|dst
index|]
operator|=
name|NULL
expr_stmt|;
block|}
end_function
end_unit
