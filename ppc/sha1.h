begin_unit
begin_comment
comment|/*  * SHA-1 implementation.  *  * Copyright (C) 2005 Paul Mackerras<paulus@samba.org>  */
end_comment
begin_include
include|#
directive|include
file|<stdint.h>
end_include
begin_typedef
DECL|struct|sha_context
typedef|typedef
struct|struct
name|sha_context
block|{
DECL|member|hash
name|uint32_t
name|hash
index|[
literal|5
index|]
decl_stmt|;
DECL|member|cnt
name|uint32_t
name|cnt
decl_stmt|;
DECL|member|len
name|uint64_t
name|len
decl_stmt|;
union|union
block|{
DECL|member|b
name|unsigned
name|char
name|b
index|[
literal|64
index|]
decl_stmt|;
DECL|member|l
name|uint64_t
name|l
index|[
literal|8
index|]
decl_stmt|;
block|}
DECL|member|buf
name|buf
union|;
block|}
DECL|typedef|SHA_CTX
name|SHA_CTX
typedef|;
end_typedef
begin_function_decl
name|int
name|SHA1_Init
parameter_list|(
name|SHA_CTX
modifier|*
name|c
parameter_list|)
function_decl|;
end_function_decl
begin_function_decl
name|int
name|SHA1_Update
parameter_list|(
name|SHA_CTX
modifier|*
name|c
parameter_list|,
specifier|const
name|void
modifier|*
name|p
parameter_list|,
name|unsigned
name|long
name|n
parameter_list|)
function_decl|;
end_function_decl
begin_function_decl
name|int
name|SHA1_Final
parameter_list|(
name|unsigned
name|char
modifier|*
name|hash
parameter_list|,
name|SHA_CTX
modifier|*
name|c
parameter_list|)
function_decl|;
end_function_decl
end_unit
