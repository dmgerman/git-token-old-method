begin_unit
begin_include
include|#
directive|include
file|"cache.h"
end_include
begin_include
include|#
directive|include
file|"prio-queue.h"
end_include
begin_function
DECL|function|intcmp
specifier|static
name|int
name|intcmp
parameter_list|(
specifier|const
name|void
modifier|*
name|va
parameter_list|,
specifier|const
name|void
modifier|*
name|vb
parameter_list|,
name|void
modifier|*
name|data
parameter_list|)
block|{
specifier|const
name|int
modifier|*
name|a
init|=
name|va
decl_stmt|,
modifier|*
name|b
init|=
name|vb
decl_stmt|;
return|return
operator|*
name|a
operator|-
operator|*
name|b
return|;
block|}
end_function
begin_function
DECL|function|show
specifier|static
name|void
name|show
parameter_list|(
name|int
modifier|*
name|v
parameter_list|)
block|{
if|if
condition|(
operator|!
name|v
condition|)
name|printf
argument_list|(
literal|"NULL\n"
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"%d\n"
argument_list|,
operator|*
name|v
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|v
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|main
name|int
name|main
parameter_list|(
name|int
name|argc
parameter_list|,
name|char
modifier|*
modifier|*
name|argv
parameter_list|)
block|{
name|struct
name|prio_queue
name|pq
init|=
block|{
name|intcmp
block|}
decl_stmt|;
while|while
condition|(
operator|*
operator|++
name|argv
condition|)
block|{
if|if
condition|(
operator|!
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"get"
argument_list|)
condition|)
name|show
argument_list|(
name|prio_queue_get
argument_list|(
operator|&
name|pq
argument_list|)
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"dump"
argument_list|)
condition|)
block|{
name|int
modifier|*
name|v
decl_stmt|;
while|while
condition|(
operator|(
name|v
operator|=
name|prio_queue_get
argument_list|(
operator|&
name|pq
argument_list|)
operator|)
condition|)
name|show
argument_list|(
name|v
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|int
modifier|*
name|v
init|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
operator|*
name|v
argument_list|)
argument_list|)
decl_stmt|;
operator|*
name|v
operator|=
name|atoi
argument_list|(
operator|*
name|argv
argument_list|)
expr_stmt|;
name|prio_queue_put
argument_list|(
operator|&
name|pq
argument_list|,
name|v
argument_list|)
expr_stmt|;
block|}
block|}
return|return
literal|0
return|;
block|}
end_function
end_unit
